# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  APPLICATIONS PIPELINE - Automated Job Hunting
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
#  TÃ¤glich um 08:00 Uhr:
#  1. Crawlt freelancermap.de nach neuen Projekten
#  2. Matcht gegen Profile (Wolfram, Ian, Michael, Teams)
#  3. Erstellt Gmail-Drafts mit Attachments
#
#  Setup:
#  â”€â”€â”€â”€â”€â”€
#  1. Schedule in GitLab: CI/CD â†’ Schedules â†’ "0 8 * * 1-5"
#  2. Variable: GMAIL_REFRESH_TOKEN (masked)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  STAGE 1: CRAWL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

applications:crawl:
  stage: .pre
  tags:
    - mac-group-shell
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule" && $APPLICATIONS_PIPELINE == "true"
    - if: $APPLICATIONS_CRAWL == "true"
    - when: manual
      allow_failure: true
  variables:
    KEYWORDS: "DevOps Kubernetes,Python Cloud,AI ML LLM,Java Spring Architekt,MLOps Platform"
    MIN_REMOTE: "50"
    MAX_PAGES: "3"
  script:
    - pip3 install requests beautifulsoup4 lxml --quiet --break-system-packages 2>/dev/null || pip3 install requests beautifulsoup4 lxml --quiet
    - python3 scripts/ci/applications_crawl.py
  artifacts:
    paths:
      - output/projects.json
    expire_in: 7 days

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  STAGE 2: MATCH
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

applications:match:
  stage: build
  tags:
    - mac-group-shell
  needs:
    - job: applications:crawl
      artifacts: true
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule" && $APPLICATIONS_PIPELINE == "true"
    - if: $APPLICATIONS_MATCH == "true"
    - when: manual
      allow_failure: true
  variables:
    MIN_SCORE: "50"
    MAX_RESULTS: "20"
  script:
    - python3 scripts/ci/applications_match.py
  artifacts:
    paths:
      - output/matches.json
    expire_in: 7 days

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  STAGE 3: CREATE GMAIL DRAFTS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

applications:drafts:
  stage: deploy
  tags:
    - mac-group-shell
  needs:
    - job: applications:match
      artifacts: true
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule" && $APPLICATIONS_PIPELINE == "true"
    - if: $APPLICATIONS_DRAFTS == "true"
    - when: manual
      allow_failure: true
  variables:
    MAX_DRAFTS: "5"
  script:
    - pip3 install requests --quiet --break-system-packages 2>/dev/null || pip3 install requests --quiet
    - python3 scripts/ci/applications_drafts.py

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  MANUAL: DRY RUN
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

applications:dry-run:
  stage: .pre
  tags:
    - mac-group-shell
  rules:
    - when: manual
  script:
    - echo "ğŸ” DRY RUN - Testing pipeline..."
    - echo "1. Would crawl - DevOps, Python, AI, Java"
    - echo "2. Would match against - Wolfram, Ian, Michael, Teams"
    - echo "3. Would create Gmail drafts"
    - echo ""
    - echo "To run for real:"
    - echo "  â†’ Set APPLICATIONS_PIPELINE=true in schedule"
    - echo "  â†’ Or trigger individual jobs manually"
